import numpy as np
from scipy import stats
from matplotlib import pyplot as plt

timesLRn = np.array([0.9260031005692094, 1.8520062011384189, 2.778009301707628, 3.7040124022768377, 4.630015502846048, 5.556018603415256, 6.482021703984466, 7.408024804553675, 8.334027905122886, 9.260031005692095, 10.186034106261303, 11.112037206830513, 12.038040307399722, 12.964043407968932, 13.890046508538141, 14.81604960910735, 15.74205270967656, 16.66805581024577, 17.59405891081498, 18.52006201138419, 19.4460651119534, 20.372068212522606, 21.298071313091818, 22.224074413661025, 23.150077514230237, 24.076080614799444, 25.002083715368656, 25.928086815937863, 26.854089916507075, 27.780093017076283, 28.706096117645494, 29.6320992182147, 30.558102318783913, 31.48410541935312, 32.41010851992233, 33.33611162049154, 34.26211472106075, 35.18811782162996, 36.11412092219917, 37.04012402276838, 37.966127123337586, 38.8921302239068, 39.81813332447601, 40.74413642504521, 41.670139525614424, 42.596142626183635, 43.522145726752846, 44.44814882732205, 45.37415192789126, 46.30015502846047])

ImfLRn = np.array([-0.0012566381849155321, -0.0013428413971937477, -0.0011329003304283017, -0.0007107662967980082, -0.0002033079929689984, 0.0002608901348374402, 0.0005845291408159046, 0.0007191460530062035, 0.0006675739759776765, 0.00047418582062993896, 0.00020749826658317055, -5.956020839648416e-5, -0.0002668577485587063, -0.0003783099725757215, -0.00038570667310352223, -0.0003055905897432974, -0.00017114182846634471, -2.179006203306905e-5, 0.00010670698403134716, 0.0001895822659317223, 0.00021660974796303305, 0.00019177447029266483, 0.00012983650398253635, 5.1114797411624726e-5, -2.4026650502846088e-5, -7.970934039564587e-5, -0.00010725628798994048, -0.00010581558052377429, -8.112918210027235e-5, -4.3054999505455904e-5, -2.6189562971076786e-6, 3.0660571080038484e-5, 5.062732864743047e-5, 5.52537412175041e-5, 4.6343482987318725e-5, 2.8427951830278445e-5, 7.2490426983598595e-6, -1.1756728766735381e-5, -2.4632155821537728e-5, -2.9528390224736377e-5, -2.6744951933935283e-5, -1.8277012865578504e-5, -7.0601029908003864e-6, 3.863265978414662e-6, 1.2052896967055315e-5, 1.611790180488538e-5, 1.5846937589170623e-5, 1.2048423509011787e-5, 6.188240631951234e-6, -5.734058271792793e-8])

RefLRn = np.array([0.0008946266146702574, 0.00016722423645226767, -0.0004425769615743453, -0.0008407683158313455, -0.00097843135839783, -0.0008705862552209611, -0.0005850063946658827, -0.00021784657165736568, 0.00013321355402915334, 0.00039135219388964444, 0.0005142652139232471, 0.000497587276043681, 0.00036914306726548566, 0.00017697718157746984, -2.5023741592414848e-5, -0.00019024799497825058, -0.0002884924918296925, -0.00030978138628408086, -0.0002629744417365942, -0.0001704190732104016, -6.055701177435252e-5, 3.9494135676760874e-5, 0.00010972559583808748, 0.0001403945917395351, 0.00013232530303381595, 9.480218567566383e-5, 4.195927378405271e-5, -1.1258752535191603e-5, -5.2585955619216576e-5, -7.469519073856329e-5, -7.594505865962081e-5, -5.971854794543622e-5, -3.275404908255582e-5, -3.023160967693154e-6, 2.22878119312788e-5, 3.825831973021645e-5, 4.2939667285706376e-5, 3.72662698584919e-5, 2.4333697690539628e-5, 8.31866357850796e-6, -6.6523168751520426e-6, -1.7421829699739894e-5, -2.233893367137409e-5, -2.136182458108678e-5, -1.577995538714347e-5, -7.685878414214427e-6, 6.396648761191452e-7, 7.275373116338191e-6, 1.1028232474733286e-5, 1.1572212388726418e-5])


times = np.array([0.4593558687863008, 0.9187117375726016, 1.3780676063589024, 1.8374234751452032, 2.296779343931504, 2.7561352127178047, 3.215491081504106, 3.6748469502904064, 4.134202819076707, 4.593558687863008, 5.052914556649309, 5.512270425435609, 5.9716262942219105, 6.430982163008212, 6.890338031794512, 7.349693900580813, 7.809049769367114, 8.268405638153414, 8.727761506939716, 9.187117375726016, 9.646473244512316, 10.105829113298618, 10.565184982084919, 11.024540850871219, 11.48389671965752, 11.943252588443821, 12.402608457230121, 12.861964326016423, 13.321320194802723, 13.780676063589024, 14.240031932375325, 14.699387801161626, 15.158743669947926, 15.618099538734228, 16.077455407520528, 16.53681127630683, 16.99616714509313, 17.455523013879432, 17.914878882665732, 18.374234751452033, 18.833590620238333, 19.292946489024633, 19.752302357810933, 20.211658226597237, 20.671014095383537, 21.130369964169837, 21.589725832956137, 22.049081701742438, 22.508437570528738, 22.96779343931504, 23.42714930810134, 23.886505176887642, 24.345861045673942, 24.805216914460242, 25.264572783246546, 25.723928652032846, 26.183284520819146, 26.642640389605447, 27.101996258391747, 27.561352127178047, 28.02070799596435, 28.48006386475065, 28.93941973353695, 29.39877560232325, 29.85813147110955, 30.31748733989585, 30.776843208682156, 31.236199077468456, 31.695554946254756, 32.154910815041056, 32.61426668382736, 33.07362255261366, 33.53297842139996, 33.99233429018626, 34.45169015897256, 34.911046027758864, 35.37040189654516, 35.829757765331465, 36.28911363411776, 36.748469502904065, 37.20782537169037, 37.667181240476665, 38.12653710926297, 38.585892978049266, 39.04524884683557, 39.504604715621866, 39.96396058440817, 40.423316453194474, 40.88267232198077, 41.342028190767074, 41.80138405955337, 42.260739928339675, 42.72009579712598, 43.179451665912275, 43.63880753469858, 44.098163403484875, 44.55751927227118, 45.016875141057476, 45.47623100984378, 45.93558687863008] )

Imf = np.array([-0.002704416710766501, -0.0032681603600381013, -0.0035463963995906404, -0.0035721464316971455, -0.003378643394913805, -0.0030039255937516413, -0.0024911152306789286, -0.0018863604868154414, -0.00123606079416789, -0.0005841463157219491, 3.0256357735075208e-5, 0.0005746248660892585, 0.0010242536131725485, 0.0013628531861325061, 0.0015825796707528996, 0.0016835664283524371, 0.001673027882773486, 0.0015640357844931344, 0.0013740832708053295, 0.0011235463621382842, 0.0008341452606580067, 0.0005274973028623307, 0.00022383814322732824, -5.9030970021347875e-5, -0.00030653239860215073, -0.0005078203614157979, -0.0006560092892949091, -0.0007481399718387325, -0.0007849151106650049, -0.0007702462640114357, -0.000710660672659865, -0.0006146192734377779, -0.0004917966770105679, -0.00035237041205699396, -0.0002063608171921479, -6.30552094926635e-5, 6.945894280244134e-5, 0.00018463648283040604, 0.0002776865070396488, 0.0003456561347926925, 0.0003873958282707528, 0.00040342192052369557, 0.00039569631921113703, 0.0003673459708920698, 0.00032234563812884944, 0.00026518699544045385, 0.00020055520080846246, 0.00013303121016696197, 6.683446673910077e-5, 5.616518166467871e-6, -4.768811470814268e-5, -9.095160550212189e-5, -0.00012288458051037797, -0.00014301476012815672, -0.00015161985792401417, -0.00014962396121287518, -0.00013846771005733192, -0.00011996295148319219, -9.614223565530524e-5, -6.911263601401093e-5, -4.0922033770415343e-5, -1.3444339751633574e-5, 1.1711731502344827e-5, 3.326763839130731e-5, 5.031290089210176e-5, 6.231675855440695e-5, 6.911590794463887e-5, 7.088178105748268e-5, 6.807164269920903e-5, 6.136825618051875e-5, 5.161300405430588e-5, 3.973718367676379e-5, 2.6695770218426203e-5, 1.3407306923619814e-5, 7.028044317462881e-7, -1.0714329875017963e-5, -2.0296195041473363e-5, -2.76658461359938e-5, -3.26207766332695e-5, -3.5125576598722375e-5, -3.5295424644656407e-5, -3.337243025256969e-5, -2.969704161078525e-5, -2.4676778760746694e-5, -1.8754457170696838e-5, -1.237785408401254e-5, -5.972464978329529e-6, 8.137133556514395e-8, 5.466103993776904e-6, 9.938893169977993e-6, 1.3337752515005383e-5, 1.5582191009513776e-5, 1.6668930691749336e-5, 1.6663505629592333e-5, 1.568870284166741e-5, 1.3910886611599168e-5, 1.1525257310944953e-5, 8.741041814834164e-6, 5.767505195366044e-6, 2.8015249712693025e-6])

Ref = np.array([0.003249628119099759, 0.002383758757643147, 0.0014369904642510178, 0.0005026398813577287, -0.00035844389134478857, -0.0011018381125092582, -0.0016961234584890069, -0.0021224656643777395, -0.0023741806612897535, -0.00245575987942245, -0.0023813575467570088, -0.002172869367388201, -0.0018577521213542763, -0.0014667762541713996, -0.0010318194511725332, -0.000583823293311024, -0.00015104720514856601, 0.00024231563218897264, 0.0005771282161642336, 0.0008398883005331978, 0.0010229048354975002, 0.0011241068134714943, 0.0011465375066444987, 0.0010975997185892928, 0.0009881250820298415, 0.0008313428897588033, 0.0006418216193171699, 0.0004344496810740796, 0.00022351196811570001, 2.1906624892070885e-5, -0.00015946695044193634, -0.00031213161975089323, -0.00043026356324172167, -0.0005107389344324763, -0.0005530143228597753, -0.0005588671209480815, -0.000532027291812611, -0.0004777349170358952, -0.0004022583889981422, -0.00031240645129858454, -0.0002150638331318596, -0.00011677538678926084, -2.3397873704582132e-5, 6.016769186050181e-5, 0.0001301565124541065, 0.00018403260492404482, 0.00022049813277609127, 0.00023942848370004613, 0.00024174545983083446, 0.0002292431834545107, 0.00020438243317503558, 0.00017006918063959428, 0.00012943221588243453, 8.561309123001647e-5, 4.157936720576304e-5, -3.049077947473367e-8, -3.702503931876817e-5, -6.773790599893067e-5, -9.106591827080248e-5, -0.00010646962724281057, -0.00011394049298213973, -0.00011394047560875771, -0.00010732074768553041, -9.522670883212344e-5, -7.899647331487719e-5, -6.005957018694522e-5, -3.984181643651013e-5, -1.968128173412423e-5, -7.590497306175372e-7, 1.5952813753610132e-5, 2.9724965552465417e-5, 4.008625328840165e-5, 4.6822105337192805e-5, 4.995788023399276e-5, 4.972987252448437e-5, 4.654709756014211e-5, 4.094717050965391e-5, 3.354956967879071e-5, 2.500935707767464e-5, 1.597405445681271e-5, 7.04588062233838e-6, -1.2490118927707013e-6, -8.483263692385691e-6, -1.434255665824533e-5, -1.8631495257579506e-5, -2.1271718039057876e-5, -2.229323140334785e-5, -2.1820249373613852e-5, -2.0053005577814282e-5, -1.7247078382006244e-5, -1.3691744719816007e-5, -9.68876538071176e-6, -5.532820852755543e-6, -1.4945811382743542e-6, 2.1928748684397483e-6, 5.343855282010792e-6, 7.825906159749049e-6, 9.561810857060743e-6, 1.052805081414546e-5, 1.075021710595641e-5])

timesHR = np.array([0.2287772366112165, 0.457554473222433, 0.6863317098336494, 0.915108946444866, 1.1438861830560825, 1.3726634196672989, 1.6014406562785155, 1.830217892889732, 2.0589951295009485, 2.287772366112165, 2.5165496027233814, 2.7453268393345978, 2.974104075945814, 3.202881312557031, 3.4316585491682474, 3.660435785779464, 3.8892130223906802, 4.117990259001897, 4.346767495613113, 4.57554473222433, 4.804321968835546, 5.033099205446763, 5.2618764420579796, 5.4906536786691955, 5.719430915280412, 5.948208151891628, 6.176985388502845, 6.405762625114062, 6.634539861725278, 6.863317098336495, 7.092094334947711, 7.320871571558928, 7.5496488081701445, 7.7784260447813605, 8.007203281392577, 8.235980518003794, 8.46475775461501, 8.693534991226226, 8.922312227837443, 9.15108946444866, 9.379866701059877, 9.608643937671092, 9.837421174282309, 10.066198410893525, 10.294975647504742, 10.523752884115959, 10.752530120727174, 10.981307357338391, 11.210084593949608, 11.438861830560825, 11.667639067172042, 11.896416303783257, 12.125193540394474, 12.35397077700569, 12.582748013616907, 12.811525250228124, 13.04030248683934, 13.269079723450556, 13.497856960061773, 13.72663419667299, 13.955411433284207, 14.184188669895422, 14.412965906506638, 14.641743143117855, 14.870520379729072, 15.099297616340289, 15.328074852951504, 15.556852089562721, 15.785629326173938, 16.014406562785155, 16.24318379939637, 16.47196103600759, 16.700738272618803, 16.92951550923002, 17.158292745841237, 17.387069982452452, 17.61584721906367, 17.844624455674886, 18.0734016922861, 18.30217892889732, 18.530956165508535, 18.759733402119753, 18.98851063873097, 19.217287875342183, 19.446065111953402, 19.674842348564617, 19.903619585175836, 20.13239682178705, 20.361174058398266, 20.589951295009485, 20.8187285316207, 21.047505768231918, 21.276283004843133, 21.50506024145435, 21.733837478065567, 21.962614714676782, 22.191391951288, 22.420169187899216, 22.64894642451043, 22.87772366112165, 23.106500897732865, 23.335278134344083, 23.5640553709553, 23.792832607566513, 24.021609844177732, 24.250387080788947, 24.479164317400166, 24.70794155401138, 24.936718790622596, 25.165496027233814, 25.39427326384503, 25.623050500456248, 25.851827737067463, 26.08060497367868, 26.309382210289897, 26.538159446901112, 26.76693668351233, 26.995713920123546, 27.22449115673476, 27.45326839334598, 27.682045629957194, 27.910822866568413, 28.139600103179628, 28.368377339790843, 28.597154576402062, 28.825931813013277, 29.054709049624496, 29.28348628623571, 29.512263522846926, 29.741040759458144, 29.96981799606936, 30.198595232680578, 30.427372469291793, 30.656149705903008, 30.884926942514227, 31.113704179125442, 31.34248141573666, 31.571258652347876, 31.80003588895909, 32.02881312557031, 32.257590362181524, 32.48636759879274, 32.715144835403954, 32.94392207201518, 33.17269930862639, 33.40147654523761, 33.63025378184882, 33.85903101846004, 34.08780825507126, 34.316585491682474, 34.54536272829369, 34.774139964904904, 35.00291720151612, 35.23169443812734, 35.46047167473856, 35.68924891134977, 35.91802614796099, 36.1468033845722, 36.375580621183424, 36.60435785779464, 36.833135094405854, 37.06191233101707, 37.290689567628284, 37.51946680423951, 37.74824404085072, 37.97702127746194, 38.20579851407315, 38.43457575068437, 38.66335298729559, 38.892130223906804, 39.12090746051802, 39.349684697129234, 39.57846193374045, 39.80723917035167, 40.03601640696289, 40.2647936435741, 40.49357088018532, 40.72234811679653, 40.951125353407754, 41.17990259001897, 41.408679826630184, 41.6374570632414, 41.866234299852614, 42.095011536463836, 42.32378877307505, 42.55256600968627, 42.78134324629748, 43.0101204829087, 43.23889771951992, 43.467674956131134, 43.69645219274235, 43.925229429353564, 44.15400666596478, 44.382783902576, 44.611561139187216, 44.84033837579843, 45.06911561240965, 45.29789284902086, 45.526670085632084, 45.7554473222433, 45.984224558854514, 46.21300179546573, 46.441779032076944, 46.670556268688166, 46.89933350529938, 47.1281107419106, 47.35688797852181, 47.58566521513303, 47.81444245174425, 48.043219688355464, 48.27199692496668, 48.500774161577894, 48.72955139818911, 48.95832863480033, 49.187105871411546, 49.41588310802276, 49.64466034463398, 49.87343758124519, 50.102214817856414, 50.33099205446763, 50.559769291078844, 50.78854652769006, 51.017323764301274, 51.246101000912496, 51.47487823752371, 51.703655474134926, 51.93243271074614, 52.16120994735736, 52.38998718396858, 52.618764420579794, 52.84754165719101, 53.076318893802224, 53.30509613041344, 53.53387336702466, 53.762650603635876, 53.99142784024709, 54.220205076858306, 54.44898231346952, 54.677759550080744, 54.90653678669196, 55.135314023303174, 55.36409125991439, 55.592868496525604, 55.821645733136826, 56.05042296974804, 56.279200206359256, 56.50797744297047, 56.736754679581686, 56.96553191619291, 57.194309152804124, 57.42308638941534, 57.651863626026554, 57.88064086263777, 58.10941809924899, 58.338195335860206, 58.56697257247142, 58.795749809082636, 59.02452704569385, 59.25330428230507, 59.48208151891629, 59.710858755527504, 59.93963599213872, 60.168413228749934, 60.397190465361156, 60.62596770197237, 60.854744938583586, 61.0835221751948, 61.312299411806016, 61.54107664841724, 61.76985388502845, 61.99863112163967, 62.227408358250884, 62.4561855948621, 62.68496283147332, 62.913740068084536, 63.14251730469575, 63.371294541306966, 63.60007177791818, 63.8288490145294, 64.05762625114062, 64.28640348775183, 64.51518072436305, 64.74395796097427, 64.97273519758548, 65.2015124341967, 65.43028967080791, 65.65906690741913, 65.88784414403035, 66.11662138064156, 66.34539861725278, 66.57417585386399, 66.80295309047521, 67.03173032708644, 67.26050756369764, 67.48928480030887, 67.71806203692007, 67.9468392735313, 68.17561651014252, 68.40439374675373, 68.63317098336495, 68.86194821997616, 69.09072545658738, 69.3195026931986, 69.54827992980981, 69.77705716642103, 70.00583440303224, 70.23461163964346, 70.46338887625468, 70.69216611286589, 70.92094334947711, 71.14972058608832, 71.37849782269954, 71.60727505931077, 71.83605229592197, 72.0648295325332, 72.2936067691444, 72.52238400575563, 72.75116124236685, 72.97993847897806, 73.20871571558928, 73.43749295220049, 73.66627018881171, 73.89504742542293, 74.12382466203414, 74.35260189864536, 74.58137913525657, 74.81015637186779, 75.03893360847901, 75.26771084509022, 75.49648808170144, 75.72526531831265, 75.95404255492387, 76.1828197915351, 76.4115970281463, 76.64037426475753, 76.86915150136873, 77.09792873797996, 77.32670597459118, 77.55548321120239, 77.78426044781361, 78.01303768442482, 78.24181492103604, 78.47059215764726, 78.69936939425847, 78.92814663086969, 79.1569238674809, 79.38570110409212, 79.61447834070334, 79.84325557731455, 80.07203281392577, 80.30081005053698, 80.5295872871482, 80.75836452375943, 80.98714176037063, 81.21591899698186, 81.44469623359306, 81.67347347020429, 81.90225070681551, 82.13102794342672, 82.35980518003794, 82.58858241664915, 82.81735965326037, 83.04613688987159, 83.2749141264828, 83.50369136309402, 83.73246859970523, 83.96124583631645, 84.19002307292767, 84.41880030953888, 84.6475775461501, 84.87635478276131, 85.10513201937253, 85.33390925598376, 85.56268649259496, 85.79146372920619, 86.0202409658174, 86.24901820242862, 86.47779543903984, 86.70657267565105, 86.93534991226227, 87.16412714887348, 87.3929043854847, 87.62168162209592, 87.85045885870713, 88.07923609531835, 88.30801333192956, 88.53679056854078, 88.765567805152, 88.99434504176321, 89.22312227837443, 89.45189951498564, 89.68067675159686, 89.90945398820809, 90.1382312248193, 90.36700846143052, 90.59578569804172, 90.82456293465295, 91.05334017126417, 91.28211740787538, 91.5108946444866, 91.7396718810978, 91.96844911770903, 92.19722635432025, 92.42600359093146, 92.65478082754268, 92.88355806415389, 93.11233530076511, 93.34111253737633, 93.56988977398754, 93.79866701059876, 94.02744424720997, 94.2562214838212, 94.48499872043242, 94.71377595704362, 94.94255319365485, 95.17133043026605, 95.40010766687728, 95.6288849034885, 95.8576621400997, 96.08643937671093, 96.31521661332214, 96.54399384993336, 96.77277108654458, 97.00154832315579, 97.23032555976701, 97.45910279637822, 97.68788003298944, 97.91665726960066, 98.14543450621187, 98.37421174282309, 98.6029889794343, 98.83176621604552, 99.06054345265674, 99.28932068926795, 99.51809792587918, 99.74687516249038, 99.9756523991016, 100.20442963571283, 100.43320687232404, 100.66198410893526, 100.89076134554647, 101.11953858215769, 101.34831581876891, 101.57709305538012, 101.80587029199134, 102.03464752860255, 102.26342476521377, 102.49220200182499, 102.7209792384362, 102.94975647504742, 103.17853371165863, 103.40731094826985, 103.63608818488107, 103.86486542149228, 104.0936426581035, 104.32241989471471, 104.55119713132594, 104.77997436793716, 105.00875160454837, 105.23752884115959, 105.4663060777708, 105.69508331438202, 105.92386055099324, 106.15263778760445, 106.38141502421567, 106.61019226082688, 106.8389694974381, 107.06774673404932, 107.29652397066053, 107.52530120727175, 107.75407844388296, 107.98285568049418, 108.2116329171054, 108.44041015371661, 108.66918739032783, 108.89796462693904, 109.12674186355027, 109.35551910016149, 109.5842963367727, 109.81307357338392, 110.04185080999513, 110.27062804660635, 110.49940528321757, 110.72818251982878, 110.95695975644, 111.18573699305121, 111.41451422966243, 111.64329146627365, 111.87206870288486, 112.10084593949608, 112.32962317610729, 112.55840041271851, 112.78717764932973, 113.01595488594094, 113.24473212255216, 113.47350935916337, 113.7022865957746, 113.93106383238582, 114.15984106899703, 114.38861830560825])

ImfHR = np.array([-0.00176196110253152, -0.0030739062303355357, -0.004267382252036178, -0.005320163162523858, -0.006224875137319857, -0.006984247963766671, -0.007605820162278408, -0.008098911337604717, -0.008473073287758044, -0.008737356184197386, -0.008900033801008555, -0.00896858703886825, -0.008949820388970008, -0.008850031785800985, -0.0086751882643173, -0.008431081927342111, -0.008123454944780931, -0.007758090687452592, -0.007340872563802359, -0.00687781419155057, -0.006375065245977805, -0.0058388973399678395, -0.005275673989830287, -0.004691808310332445, -0.0040937116624996245, -0.0034877360906019404, -0.002880113042239898, -0.0022768905653943157, -0.0016838709110972873, -0.0011065502313196756, -0.0005500618410017064, -1.912430481399858e-5, 0.0004820045910176247, 0.0009495671162433626, 0.0013803374483442041, 0.001771645609622475, 0.002121393182067728, 0.0024280606675653803, 0.0026907065283027953, 0.002908958099851343, 0.003082994715503884, 0.003213523513243525, 0.003301748514604086, 0.003349333666288228, 0.003358360619664793, 0.0033312820894285653, 0.003270871680379476, 0.003180171100422722, 0.003062435688815809, 0.0029210791820336074, 0.002759618616339472, 0.0025816202274664317, 0.002390647155196527, 0.0021902096957462005, 0.001983718769545584, 0.001774443188174056, 0.0015654712138838927, 0.0013596768103297107, 0.0011596908858241151, 0.0009678777325994851, 0.000786316769016289, 0.0006167895981354321, 0.0004607723071276966, 0.00031943284901166536, 0.00019363327238402912, 8.393649711800636e-5, -9.382724769512399e-6, -8.632307318480835e-5, -0.00014713859854499745, -0.00019231781399601207, -0.00022256043998423986, -0.00023875230984376884, -0.00024193894572318024, -0.0002332983061062589, -0.00021411319005134883, -0.00018574375986099285, -0.00014960061405739958, -0.00010711880720208169, -5.973317322202697e-5, -8.85526547181094e-6, 4.4147819247110495e-5, 9.797251310859055e-5, 0.00015139557482709743, 0.00020328848917460619, 0.0002526293923512292, 0.00029851249244799673, 0.0003401549971559945, 0.0003769016007958004, 0.00040822661918113484, 0.00043373389340097327, 0.0004531546120096153, 0.00046634322515173377, 0.0004732716437065178, 0.00047402193158438866, 0.00046877770990393205, 0.0004578144980413573, 0.0004414892186712538, 0.00042022909215467266, 0.0003945201402765078, 0.0003648955107271306, 0.0003319238222329707, 0.00029619771625985616, 0.0002583227851482497, 0.00021890702880431178, 0.00017855097307679853, 0.0001378385631008171, 9.732892457445339e-5, 5.754906552212537e-5, 1.898757093322656e-5, -1.7910676938890315e-5, -5.274873859136001e-5, -8.518082123936568e-5, -0.00011491446673743758, -0.00014171175833612373, -0.00016538959441910592, -0.00018581908891085588, -0.00020292416780653353, -0.00021667943922316953, -0.00022710742050564625, -0.00023427521027369208, -0.0002382906959252069, -0.00023929838809891738, -0.0002374749730486896, -0.00023302467191350018, -0.0002261744926160479, -0.000217169455735256, -0.0002062678703272573, -0.00019373672947420716, -0.00017984728848061452, -0.0001648708812717938, -0.0001490750228340547, -0.00013271983762092046, -0.00011605484587575304, -9.931613192082855e-5, -8.272391075725015e-5, -6.648050191808923e-5, -5.0768712514734556e-5, -3.5750624895936186e-5, -2.15667783688884e-5, -8.335729066350608e-6, 3.846032676093438e-6, 1.4903832115739202e-5, 2.4784255114644455e-5, 3.345431908163002e-5, 4.0900402548593287e-5, 4.712696741426354e-5, 5.21551085844412e-5, 5.602096583693706e-5, 5.877403228495369e-5, 6.047539285321776e-5, 6.119592476984719e-5, 6.101449026999745e-5, 6.001614956309512e-5, 5.8290419693238305e-5, 5.592960228133124e-5, 5.302720033596412e-5, 4.9676441414305386e-5, 4.5968921458077366e-5, 4.1993380673510424e-5, 3.783461991463442e-5, 3.357256320870657e-5, 2.928146936869466e-5, 2.5029293103353244e-5, 2.0877193688326103e-5, 1.687918712458178e-5, 1.3081935800960454e-5, 9.52466800836338e-6, 6.23921823203792e-6, 3.2501779788644147e-6, 5.751459776524862e-7, -1.7749340825860379e-6, -3.7953605469119253e-6, -5.487198001185605e-6, -6.85675116855726e-6, -7.9150007748679e-6, -8.677013286615528e-6, -9.161335891956963e-6, -9.389387424963178e-6, -9.384855147225898e-6, -9.173106420321003e-6, -8.780623348810195e-6, -8.23446746716156e-6, -7.561780505170432e-6, -6.7893262141137455e-6, -5.943077187663221e-6, -5.047849583772681e-6, -4.126987661010195e-6, -3.2020990981028456e-6, -2.2928411800046995e-6, -1.416757116981738e-6, -5.89161022606371e-7, 1.7693058205496794e-7, 8.708234433691864e-7, 1.4841296187132487e-6, 2.0107144733347423e-6, 2.4466105218179432e-6, 2.7899022258127803e-6, 3.040585996941592e-6, 3.200409712315696e-6, 3.2726960351210695e-6, 3.262153750280173e-6, 3.174681181877712e-6, 3.0171655619184548e-6, 2.7972819764337547e-6, 2.5232952325043693e-6, 2.2038676759835593e-6, 1.8478756520588388e-6, 1.4642369465518486e-6, 1.0617511819873234e-6, 6.489547755398748e-7, 2.339917020990138e-7, -1.7549904953725052e-7, -5.724787809129726e-7, -9.505869257173537e-7, -1.3042015079682686e-6, -1.6284825721815156e-6, -1.9193991904826208e-6, -2.1737408716912036e-6, -2.389114386963467e-6, -2.5639271849602042e-6, -2.6973586966094977e-6, -2.789320925756572e-6, -2.8404097882022934e-6, -2.8518486991019553e-6, -2.825425919064698e-6, -2.7634271545021157e-6, -2.6685648700163117e-6, -2.543905712282429e-6, -2.3927973685013423e-6, -2.2187960906998388e-6, -2.0255960126049e-6, -1.816961271180536e-6, -1.5966618228078224e-6, -1.368413717046953e-6, -1.1358244613610886e-6, -9.023439803759631e-7, -6.712215452948595e-7, -4.4546892489191954e-7, -2.278298907666063e-7, -2.0756097738605545e-8, 1.736107433494424e-7, 3.534505775471578e-7, 5.172708639291376e-7, 6.639069152202425e-7, 7.925171170007266e-7, 9.025734762654138e-7, 9.938479897008622e-7, 1.0663953517396968e-6, 1.1205325416131558e-6, 1.1568158377522424e-6, 1.1760158076071698e-6, 1.1790908119883073e-6, 1.1671595461865904e-6, 1.1414731162776583e-6, 1.1033871190668197e-6, 1.0543341590328593e-6, 9.95797196328886e-7, 9.292840773427345e-7, 8.563035544319001e-7, 7.783430551187012e-7, 6.968484141049409e-7, 6.132057347310688e-7, 5.287255006882055e-7, 4.44629014547751e-7, 3.620371975825924e-7, 2.8196174591749306e-7, 2.0529860168475912e-7, 1.328236649143883e-7, 6.519064261508333e-8, 2.9309060849686672e-9, -5.354479396502354e-8, -1.0394292235108273e-7, -1.480822457882542e-7, -1.8588760167972508e-7, -2.1738254619669426e-7, -2.4268108087245426e-7, -2.6197865598252054e-7, -2.755426449969459e-7, -2.837024776672107e-7, -2.868396101646243e-7, -2.853774994502362e-7, -2.797717360657941e-7, -2.705004751307622e-7, -2.5805528984766677e-7, -2.4293255558384146e-7, -2.2562545592564022e-7, -2.0661668528753595e-7, -1.863719059789322e-7, -1.6533400133816043e-7, -1.4391815086266427e-7, -1.2250773839624795e-7, -1.0145109054962582e-7, -8.105902977183932e-8, -6.160321497093949e-8, -4.331523238796389e-8, -2.6386390616344845e-8, -1.096816626086775e-8, 2.826759247187154e-9, 1.492293573540826e-8, 2.528012053916188e-8, 3.389086407247222e-8, 4.077777453599854e-8, 4.5990531081565485e-8, 4.9602713202435126e-8, 5.170851162052162e-8, 5.241938260956798e-8, 5.186070364482178e-8, 5.016848362501799e-8, 4.748617579162346e-8, 4.3961635991629055e-8, 3.97442632084423e-8, 3.4982353430284444e-8, 2.982069204014624e-8, 2.439840409144435e-8, 1.8847076166184877e-8, 1.3289158075601783e-8, 7.836647525077732e-9, 2.5900560837946654e-9, -2.3623495770765977e-9, -6.945041147996452e-9, -1.1095470280729164e-8, -1.4764074733790624e-8, -1.7914067951487266e-8, -2.0521032944693843e-8, -2.257234283165164e-8, -2.4066431411772865e-8, -2.5011937705868546e-8, -2.542674852912197e-8, -2.533696289994243e-8, -2.47758014638478e-8, -2.378248316500818e-8, -2.2401090169447352e-8, -2.0679440574890308e-8, -1.8667986775176046e-8, -1.641875552417807e-8, -1.3984343806648486e-8, -1.1416982611261162e-8, -8.7676786523934e-9, -6.085442037482466e-9, -3.4166058589851003e-9, -8.04241733844537e-10, 1.7123265545871706e-9, 4.097910914005122e-9, 6.321749527983567e-9, 8.357702875886094e-9, 1.0184359216531712e-8, 1.1785054717758731e-8, 1.314781439455755e-8, 1.4265220823796145e-8, 1.5134218234466712e-8, 1.5755860032295544e-8, 1.6135008112398934e-8, 1.627999245152626e-8, 1.620223946227906e-8, 1.5915877447073508e-8, 1.5437327222329535e-8, 1.4784885607198048e-8, 1.3978309000517308e-8, 1.3038403719451578e-8, 1.1986629158358801e-8, 1.08447191616839e-8, 9.634326304550589e-9, 8.37669305314361e-9, 7.092353047113836e-9, 5.8008650203945575e-9, 4.520581166267112e-9, 3.268451067418412e-9, 2.059861661065337e-9, 9.085131007097845e-10, -1.736701838056441e-10, -1.1765944323597592e-9, -2.0920191595046722e-9, -2.9135494589904424e-9, -3.6366003744779e-9, -4.258335966577967e-9, -4.7775859080647034e-9, -5.1947425805375885e-9, -5.511641729329874e-9, -5.73142976218711e-9, -5.85842075491587e-9, -5.897946158095573e-9, -5.8562000877367345e-9, -5.7400829344485905e-9, -5.557045845442764e-9, -5.3149384268510935e-9, -5.021861785691408e-9, -4.6860287866208555e-9, -4.315633143470213e-9, -3.918728704331636e-9, -3.5031200262768416e-9, -3.0762650758810452e-9, -2.645190638516258e-9, -2.216420776345697e-9, -1.7959184451591871e-9, -1.3890401662518897e-9, -1.0005034536284214e-9, -6.343665206207878e-10, -2.940196348087379e-10, 1.781264323937589e-11, 2.9905921300123186e-10, 5.482811432238836e-10, 7.646423685835853e-10, 9.478734505203752e-10, 1.0982295040590339e-9, 1.2164433982622737e-9, 1.3036753259490842e-9, 1.36145981001732e-9, 1.3916511708382105e-9, 1.3963684235433996e-9, 1.3779405074671315e-9, 1.3388526744308462e-9, 1.281694779853931e-9, 1.2091121326988206e-9, 1.1237594688070209e-9, 1.0282585189665962e-9, 9.251595496784782e-10, 8.169071625439928e-10, 7.05810548828169e-10, 5.94018310265329e-10, 4.834978766126734e-10, 3.7601947571269426e-10, 2.731445436241574e-10, 1.7621840129149112e-10, 8.636697065515197e-11, 4.497257320992987e-12, -6.869871097823016e-11, -1.3273683089849626e-10, -1.873311180070951e-10, -2.3238152711280723e-10, -2.679597838365983e-10, -2.94293613786329e-10, -3.117497504367366e-10, -3.2081609192837007e-10, -3.2208336109857636e-10, -3.1622660278803377e-10, -3.039868284909289e-10, -2.8615309140579506e-10, -2.6354524556330793e-10, -2.3699761160878147e-10, -2.0734373962871713e-10, -1.754024267291158e-10, -1.41965114455981e-10, -1.0778475910880389e-10, -7.356623699979812e-11, -3.9958317166478093e-11, -7.547206308973947e-12, 2.3148354904235025e-11, 5.168048829499091e-11, 7.767413227028638e-11, 1.008276364948845e-10, 1.2091209540535247e-10, 1.3776953137430603e-10, 1.513100481194802e-10, 1.61508082038684e-10, 1.6839788363705329e-10, 1.7206836322926425e-10, 1.7265743480748036e-10, 1.7034598955099161e-10, 1.6535162612025153e-10, 1.5792225884548158e-10, 1.4832971741728277e-10, 1.3686344294843194e-10, 1.2382437553828824e-10, 1.0951911796758532e-10, 9.425444910939581e-11, 7.833224928017013e-11, 6.204488827948174e-11, 4.567111547070004e-11, 2.9472480113265776e-11, 1.3690299428835379e-11, -1.4568182923728738e-12, -1.5774897742439135e-11, -2.9095978733097138e-11, -4.127897522926437e-11, -5.2210037057480065e-11, -6.180244608502734e-11, -6.999608370821335e-11, -7.675651055158187e-11, -8.207370237468672e-11, -8.59604883349951e-11, -8.845073900313228e-11, -8.959735192004005e-11, -8.94700820844578e-11, -8.815326363127023e-11, -8.574346718080843e-11, -8.23471349849636e-11, -7.807823314978657e-11, -7.305595695947243e-11, -6.740252174666106e-11, -6.124106793096566e-11, -5.469370486122851e-11, -4.787971402330531e-11, -4.091392808580135e-11, -3.3905298217462076e-11, -2.6955658182251248e-11, -2.0158689955503933e-11, -1.3599092054094338e-11, -7.35194847546403e-12, -1.4822931276640492e-12, 3.955138068773356e-12])

RefHR = np.array([0.01321419902830766, 0.012175447432812363, 0.011294271580891425, 0.010422965089614895, 0.009535863739362565, 0.008638517475878191, 0.007742182850240745, 0.00685719546223635, 0.005991715069993817, 0.005151937571180736, 0.004342620253320316, 0.003567574227934678, 0.0028300324168311986, 0.0021328877092447835, 0.0014788240338844871, 0.0008703688369954851, 0.00030989267163829086, -0.0002004237344736247, -0.0006586399155421237, -0.0010631130445944571, -0.001412555075334159, -0.001706084925633461, -0.0019432727038178445, -0.002124174175550125, -0.002249354498924003, -0.0023199008370012133, -0.0023374238732860745, -0.002304048562036835, -0.0022223946778448717, -0.002095547910150378, -0.001927022391986436, -0.0017207156662007715, -0.001480857181081864, -0.0012119514729901654, -0.0009187172373924117, -0.0006060235122141515, -0.000278824199121448, 5.7907870223163386e-5, 0.00039924615391805177, 0.0007403737929840452, 0.0010766441386788202, 0.0014036374633026609, 0.0017172130056603428, 0.002013555615185343, 0.0022892163801984237, 0.0025411467533619963, 0.002766725818554516, 0.0029637804755871947, 0.0031305984499469773, 0.0032659341617249002, 0.003369007608893596, 0.0034394965331554076, 0.0034775222399573732, 0.0034836295364911573, 0.0034587613313798488, 0.0034042285064085596, 0.003321675723491036, 0.0032130438687835426, 0.0030805298604501675, 0.0029265445573105997, 0.0027536695029735706, 0.002564613224813376, 0.002362167780219638, 0.0021491662050455223, 0.0019284414723394958, 0.0017027875146156484, 0.0014749228015163117, 0.0012474568982058806, 0.001022860359674123, 0.0008034382437685672, 0.0005913074526210858, 0.00038837803951533397, 0.0001963385474010298, 1.6645377330854622e-5, -0.00014948387891329675, -0.0003010732669494266, -0.00043738763730290914, -0.0005579283784706396, -0.0006624259827095266, -0.0007508297458426873, -0.0008232949294817806, -0.000880167734125991, -0.0009219684447200568, -0.0009493731166537586, -0.0009631941701847484, -0.0009643602552773916, -0.0009538957373609645, -0.0009329001380723607, -0.0009025278442610574, -0.0008639683740316925, -0.0008184274610371433, -0.0007671091882750728, -0.0007111993709418648, -0.0006518503551022978, -0.0005901673656578913, -0.0005271965039238935, -0.0004639144625940421, -0.0004012199944747459, -0.0003399271415438391, -0.00028076020301378885, -0.00022435039547593139, -0.0001712341351307936, -0.00012185285176886141, -7.655422669553684e-5, -3.5594732274964615e-5, 8.566607735679899e-7, 3.271375078061064e-5, 5.996749539311952e-5, 8.267967580210946e-5, 0.00010097598635489127, 0.00011503869886801247, 0.00012509904662868324, 0.00013142946675472677, 0.00013433583152320697, 0.0001341497897334584, 0.00013122132840423628, 0.00012591165338062294, 0.00011858647500380985, 0.00010960977212771136, 9.933809469091483e-5, 8.811545199649329e-5, 7.626882102436264e-5, 6.410429669042488e-5, 5.190389414204785e-5, 3.992300208667008e-5, 2.83884759127886e-5, 1.749735008042347e-5, 7.4161410084653105e-6, -1.7192954763638126e-6, -9.803394107062817e-6, -1.676004444937752e-5, -2.254134015512656e-5, -2.7125966556253802e-5, -3.0517281585986546e-5, -3.274114563443632e-5, -3.384355562866274e-5, -3.3888137448417216e-5, -3.295354883333021e-5, -3.113084229607924e-5, -2.8520834324087297e-5, -2.5231523426799655e-5, -2.1375595464348153e-5, -1.706805027307838e-5, -1.242397897806212e-5, -7.556516642474695e-6, -2.5749901336706976e-6, 2.4167236350505454e-6, 7.321618527481914e-6, 1.2050752926323729e-5, 1.652421441856115e-5, 2.0671857328914616e-5, 2.443381855453015e-5, 2.776082034008039e-5, 3.061427143248603e-5, 3.296618045324315e-5, 3.4798897316183266e-5, 3.61047000989092e-5, 3.6885245953267135e-5, 3.715090542618079e-5, 3.691999997448693e-5, 3.621796251823126e-5, 3.507644061231148e-5, 3.3532361255717937e-5, 3.1626975532734046e-5, 2.940490022494148e-5, 2.6913172281455084e-5, 2.420033062269093e-5, 2.1315538215221646e-5, 1.8307755726280748e-5, 1.5224976379444604e-5, 1.2113529919526861e-5, 9.017461884336717e-6, 5.977992700923934e-6, 3.033059498922194e-6, 2.1694198549013406e-7, -2.4400277258990196e-6, -4.911672780982508e-6, -7.176099408341331e-6, -9.215748645827281e-6, -1.1017376653591129e-5, -1.2571969090650131e-5, -1.387459567751423e-5, -1.4924211566342897e-5, -1.5723412495627582e-5, -1.6278150923732895e-5, -1.659742042183716e-5, -1.6692915570500565e-5, -1.6578674455159016e-5, -1.6270710605245567e-5, -1.5786640881104307e-5, -1.514531539465675e-5, -1.4366455066470281e-5, -1.3470301886110299e-5, -1.2477286366938923e-5, -1.1407716083048792e-5, -1.0281488556486369e-5, -9.11783113838676e-6, -7.935069908405012e-6, -6.750429012305579e-6, -5.579861276232507e-6, -4.437910385472684e-6, -3.337604401840718e-6, -2.290379922468942e-6, -1.3060357580176085e-6, -3.927146333009137e-7, 4.430889098056383e-7, 1.1964964973978063e-6, 1.86419210355677e-6, 2.4443488965766816e-6, 2.9365393356213167e-6, 3.341631165927094e-6, 3.6616719782287483e-6, 3.899764972563511e-6, 4.059938501704298e-6, 4.147011869216728e-6, 4.166459725813279e-6, 4.124277249736686e-6, 4.026848116870743e-6, 3.880817068677123e-6, 3.6929686753494994e-6, 3.470113672083321e-6, 3.218984022208951e-6, 2.9461376360123436e-6, 2.65787345196849e-6, 2.3601573711138585e-6, 2.058559328313183e-6, 1.7582015887910826e-6, 1.4637181766792625e-6, 1.1792251762690036e-6, 9.083014975645249e-7, 6.539795666388191e-7, 4.1874528886773615e-7, 2.045465396825466e-7, 1.280936303308035e-8, -1.5553899800914176e-7, -3.0004115173004126e-7, -4.2067562291225764e-7, -5.178188702978407e-7, -5.922041830553465e-7, -6.448783582300315e-7, -6.771570241930908e-7, -6.905794274227598e-7, -6.868634431361628e-7, -6.67861505956584e-7, -6.355180865503682e-7, -5.918292655736193e-7, -5.388048788502996e-7, -4.784336289055246e-7, -4.126514791554513e-7, -3.433135694572758e-7, -2.721698164822895e-7, -2.008442904982339e-7, -1.308183925095374e-7, -6.341779304476541e-8, 1.9696319730565592e-10, 5.903633366091032e-8, 1.1228432666961047e-7, 1.5929795210450336e-7, 1.9960383492061528e-7, 2.3289227712383846e-7, 2.590090720351517e-7, 2.7794538657461515e-7, 2.898260332104997e-7, 2.948964535159506e-7, 2.9350873039357305e-7, 2.86106936452291e-7, 2.732121122724786e-7, 2.5540715092192196e-7, 2.3332184464886844e-7, 2.0761832674614073e-7, 1.7897711671436014e-7, 1.480839506019596e-7, 1.1561755129304802e-7, 8.223846605196934e-8, 4.8579071282716305e-8, 1.5234817651032566e-8, -1.724323716618963e-8, -4.835458545402709e-8, -7.765411655578171e-8, -1.0475567573339089e-7, -1.293343756643003e-7, -1.5112771851820458e-7, -1.6993560136315108e-7, -1.8561929013105594e-7, -1.9809945750908871e-7, -2.073533879358473e-7, -2.1341145842556447e-7, -2.1635300730739366e-7, -2.1630170426578198e-7, -2.1342053444169025e-7, -2.0790650696247644e-7, -1.9998519428597785e-7, -1.8990520335877356e-7, -1.779326729948294e-7, -1.6434588427781088e-7, -1.4943006237814936e-7, -1.3347243915170357e-7, -1.1675763644224626e-7, -9.956342032867555e-8, -8.215686681286496e-8, -6.479096979622763e-8, -4.7701712789100215e-8, -3.110561676849471e-8, -1.5197768061934854e-8, -1.5032218664421866e-10, 1.388852770416716e-8, 2.679513565814778e-8, 3.847056469258327e-8, 4.884035408738247e-8, 5.785392490665887e-8, 6.548365973230821e-8, 7.172369505053014e-8, 7.658846639217363e-8, 8.011104722480102e-8, 8.234132277263012e-8, 8.334403945224332e-8, 8.319676951594128e-8, 8.19878288547999e-8, 7.981418379752535e-8, 7.677938021912548e-8, 7.299152541631153e-8, 6.856135008536747e-8, 6.360037442265735e-8, 5.8219198925401213e-8, 5.252593696507869e-8, 4.662480269812252e-8, 4.061486442414178e-8, 3.458897015134434e-8, 2.863284892714531e-8, 2.2824388478375583e-8, 1.7233086913250377e-8, 1.1919673693489879e-8, 6.935892810823319e-9, 2.324439112796718e-9, -1.8809629721071106e-9, -5.655350456385302e-9, -8.982195807505048e-9, -1.1852978005558657e-8, -1.4266665220321299e-8, -1.622912393863468e-8, -1.7752469375930116e-8, -1.8854371775669754e-8, -1.9557332759085885e-8, -1.988794525807714e-8, -1.9876149770899098e-8, -1.9554498748489446e-8, -1.8957439874274774e-8, -1.812062786732134e-8, -1.7080273242368184e-8, -1.587253522436565e-8, -1.4532964762172662e-8, -1.3096002337105487e-8, -1.1594534036455687e-8, -1.0059508177404102e-8, -8.519613638456873e-9, -7.001019997029998e-9, -5.527178594378439e-9, -4.118682761820407e-9, -2.793184652129754e-9, -1.5653654319640515e-9, -4.46955008175116e-10, 5.532030161625557e-10, 1.4290458319013915e-9, 2.1771503048346785e-9, 2.796561361893936e-9, 3.2885950723834516e-9, 3.6566216016955737e-9, 3.905833121662269e-9, 4.0430015953285205e-9, 4.0762311228282034e-9, 4.014709247923787e-9, 3.868461290566927e-9, 3.6481113985255218e-9, 3.3646536095880427e-9, 3.0292357937497407e-9, 2.6529589104127377e-9, 2.2466935768439028e-9, 1.8209155082393405e-9, 1.3855609634346943e-9, 9.499029195940917e-10, 5.22448309408642e-10, 1.10856289992281e-10, -2.781228224253823e-10, -6.386886207091619e-10, -9.660126148569362e-10, -1.2562423488877307e-9, -1.5064889907034485e-9, -1.7147999169539251e-9, -1.8801179360437323e-9, -2.0022288776865603e-9, -2.081699328289337e-9, -2.1198063098180383e-9, -2.118460687914577e-9, -2.0801260554592265e-9, -2.007734773306327e-9, -1.9046027635408915e-9, -1.7743445454049057e-9, -1.6207898831777357e-9, -1.447903281921356e-9, -1.2597074242274931e-9, -1.0602114919471336e-9, -8.53345164225987e-10, -6.428989297265937e-10, -4.324711992037957e-10, -2.2542255690656202e-10, -2.4837347654490654e-11, 1.665073373260694e-10, 3.461653370959818e-10, 5.120379352443543e-10, 6.623834887826156e-10, 7.958205385202236e-10, 9.113248446326334e-10, 1.0082208549411066e-9, 1.0861681641540655e-9, 1.145143560174156e-9, 1.1854192789471148e-9, 1.2075381027792648e-9, 1.2122859392883813e-9, 1.2006625100097569e-9, 1.1738507600887508e-9, 1.1331855744645688e-9, 1.0801223525549553e-9, 1.0162059537906167e-9, 9.430404815384407e-10, 8.622603241065534e-10, 7.755028197330266e-10, 6.843828587768628e-10, 5.904696817570459e-10, 4.952660773617479e-10, 4.0019013094064725e-10, 3.0655962208296464e-10, 2.155791203685164e-10, 1.2832978186346497e-10, 4.5761805926567675e-11, -3.13105271896384e-11, -1.0221135229461889e-10, -1.664033934878611e-10, -2.2348598712532506e-10, -2.7319114507385616e-10, -3.153778662420479e-10, -3.500249162659605e-10, -3.7722230272922993e-10, -3.97161676627174e-10, -4.10125890210645e-10, -4.1647793717625584e-10, -4.1664949374713697e-10, -4.1112926887986165e-10, -4.004513590233869e-10, -3.8518378793965655e-10, -3.659173954707816e-10, -3.432552211988127e-10, -3.1780251007580443e-10, -2.901574476741162e-10, -2.6090271306994345e-10, -2.3059791785356593e-10, -1.997729806573306e-10, -1.689224681768586e-10, -1.3850091617060543e-10, -1.0891912756291155e-10, -8.054142971756175e-11, -5.368385933026256e-11, -2.8613231313595556e-11, -5.547037588686664e-12, 1.534588710530463e-11, 3.3944002408420225e-11, 5.017107805251005e-11, 6.399366747128853e-11, 7.541812101585567e-11, 8.44872213449296e-11, 9.127652305514399e-11, 9.589047686120614e-11, 9.845841575298326e-11, 9.91304766794081e-11, 9.807352657561093e-11, 9.546715610094255e-11, 9.149979843295716e-11, 8.636502400554117e-11, 8.025805532380511e-11, 7.337253906394654e-11, 6.589760569548185e-11, 5.8015239959718775e-11, 4.9897978805915285e-11, 4.1706946918285314e-11, 3.359023384452668e-11, 2.5681611029693246e-11, 1.8099581825871132e-11, 1.0946752834083182e-11, 4.3095107742340505e-12, -1.7420145056322521e-12, -7.153723266161955e-12, -1.1887080152259552e-11, -1.591843612576837e-11, -1.923816593432646e-11, -2.184964971527493e-11, -2.376812754328378e-11, -2.5019455466653587e-11, -2.5638790881237878e-11, -2.566923400744428e-11, -2.5160450812303115e-11, -2.4167301004308362e-11])

ID = np.array([0.026772107463932243,
0.026796736240341252,
0.02687074229735433,
0.026994485723887695,
0.027168569694200968,
0.027393845033252495,
0.027671416660579935,
0.028002651964572665,
0.02838919117304229,
0.0288329597991642,
0.029336183253847927,
0.029901403725805367,
0.03053149943821845,
0.031229706394952525,
0.031999642728269696,
0.03284533575208847,
0.03377125180753965,
0.03478232895754329,
0.03588401254029619,
0.0370822935221953,
0.03838374949210619,
0.03979558800171331,
0.04132569177004485,
0.04298266501962255,
0.04477587987999206,
0.04671552135971346,
0.048812628825215545,
0.05107913120328136,
0.05352787220961742,
0.056172620760280755,
0.05902806030763778,
0.06210974912161015,
0.06543404148615098,
0.0690179573971631,
0.07287898567153896,
0.07703480251403354,
0.08150288475504082,
0.08629999453894327,
0.09144151080613562,
0.09694058336069342,
0.10280708890605787,
0.1090463768182501,
0.11565780762768058,
0.12263311136915406,
0.12995462799538265,
0.1375935386011663,
0.14550825238832316,
0.15364317385706955,
0.16192812514748894,
0.17027872010687642,
0.178597954366644,
0.18677916521502508,
0.19471031528673666,
0.20227928321494903,
0.20937956150039366,
0.2159155612315303,
0.221806701317162,
0.226989662266905,
0.2314185660640335,
0.23506327802537733,
0.2379063704425381,
0.23993945487420312,
0.241159580283476,
0.24156626776654463])

cheb_ID = np.array([0.037093451747484595,
0.03710464167208219,
0.0371382117079867,
0.03719416252124315,
0.037272494820482414,
0.037373208753097936,
0.03749630305662901,
0.037641773962205374,
0.037809613846179785,
0.037999809625482016,
0.0382123408918004,
0.03844717777947627,
0.038704278562018656,
0.03898358697245952,
0.03928502924341482,
0.0396085108637491,
0.03995391305020957,
0.04032108893435506,
0.040709859467613796,
0.041120009050413166,
0.041551280895090414,
0.04200337213676496,
0.0424759287115709,
0.04296854002764746,
0.04348073346107892,
0.04401196871656528,
0.04456163210096371,
0.045129030766914616,
0.04571338699346916,
0.046313832580838044,
0.0469294034469081,
0.0475590345238026,
0.04820155506320811,
0.04885568446912836,
0.04952002878576199,
0.050193077975898164,
0.050873204131092475,
0.051558660758404345,
0.05224758328909934,
0.052937990951904275,
0.05362779014662955,
0.054314779442770626,
0.05499665631168575,
0.055671025679845276,
0.05633541036434482,
0.0569872634204334,
0.057623982394513724,
0.05824292543544175,
0.05884142917275615,
0.059416828223727916,
0.059966476143095526,
0.06048776758151516,
0.06097816137275046,
0.06143520422720009,
0.06185655467230092,
0.0622400068503868,
0.06258351376332927,
0.06288520954211019,
0.06314343031943923,
0.06335673329530428,
0.06352391360915831,
0.06364401866804903,
0.0637163596266362,
0.06374051977148824])

read_in_ID = np.array([0.2311485522621989,
0.22077678256110805,
0.21058845953870167,
0.20069883051672502,
0.19118598078601373,
0.18208091068273324,
0.17341858624162232,
0.1652134002215082,
0.1574623356558043,
0.1501495612851206,
0.14325125007387604,
0.13673978409199153,
0.13063843281853044,
0.12494509528205208,
0.1195612916335915,
0.11445953266123796,
0.10966643279546373,
0.10520765325720088,
0.10096058355637716,
0.09690987366856384,
0.09318399459773784,
0.08961789614872866,
0.08620079523932068,
0.08304908440327594,
0.08002442079242239,
0.07712211096919169,
0.07443946190447326,
0.07184919935495052,
0.06937866105811247,
0.06706685546821715,
0.06483016007293149,
0.06271363053483014,
0.06070574726755723,
0.05876130041230449,
0.05693420352133677,
0.055179538675142165,
0.05348002264400595,
0.051889406201898816,
0.05034859441393266,
0.0488594977647714,
0.04745933227336312,
0.04610090974904521,
0.04478671185067419,
0.04354708634458273,
0.04234514500616713,
0.041182190308007974,
0.04007290846297097,
0.039005502115071075,
0.03797277654491688,
0.036975028185918676,
0.036017937106815966,
0.03509649096806271,
0.03420546765781346,
0.033344426941121594,
0.032512624822515386,
0.03170905143784501,
0.03093246135690588,
0.030181396921992225,
0.029454205186094384,
0.028750880386120732,
0.028070228694196755,
0.02741076754360793,
0.026772107463932167,
0.026143132108855667])

rs_read_in = np.array([0.009260031005692095, 0.01852006201138419, 0.027780093017076284, 0.03704012402276838, 0.04630015502846047, 0.05556018603415257, 0.06482021703984467, 0.07408024804553676, 0.08334027905122884, 0.09260031005692095, 0.10186034106261305, 0.11112037206830513, 0.12038040307399722, 0.12964043407968934, 0.13890046508538142, 0.1481604960910735, 0.1574205270967656, 0.1666805581024577, 0.1759405891081498, 0.1852006201138419, 0.19446065111953398, 0.2037206821252261, 0.21298071313091818, 0.22224074413661027, 0.23150077514230236, 0.24076080614799444, 0.25002083715368656, 0.2592808681593787, 0.26854089916507073, 0.27780093017076285, 0.2870609611764549, 0.296320992182147, 0.30558102318783914, 0.3148410541935312, 0.3241010851992233, 0.3333611162049154, 0.3426211472106075, 0.3518811782162996, 0.36114120922199167, 0.3704012402276838, 0.3796612712333759, 0.38892130223906796, 0.39818133324476007, 0.4074413642504522, 0.41670139525614425, 0.42596142626183636, 0.4352214572675284, 0.44448148827322054, 0.45374151927891265, 0.4630015502846047, 0.47226158129029683, 0.4815216122959889, 0.490781643301681, 0.5000416743073731, 0.5093017053130652, 0.5185617363187573, 0.5278217673244494, 0.5370817983301415, 0.5463418293358335, 0.5556018603415257, 0.5648618913472178, 0.5741219223529098, 0.583381953358602, 0.592641984364294])

rs_ID = [0.5833819533586022, 0.5830193584948604, 0.5819324753715973, 0.5801240061515092, 0.5775984469740232, 0.5743620767771875, 0.5704229416872406, 0.5657908350146749, 0.5604772729065228, 0.554495465715402, 0.5478602851564955, 0.5405882273341265, 0.5326973717298423, 0.5242073362539754, 0.5151392284724271, 0.505515593129933, 0.4953603561002752, 0.4846987649027904, 0.47355732593305905, 0.4619637385638288, 0.44994682628001026, 0.4375364650189516, 0.42476350889415126, 0.41165971348706965, 0.3982576568977512, 0.3845906587505339, 0.3706926973562134, 0.3565983252366087, 0.34234258322154887, 0.3279609133318486, 0.3134890706648608, 0.2989630345016702, 0.28441891885693205, 0.26989288269374145, 0.2554210400267536, 0.2410393701370534, 0.2267836281219935, 0.21268925600238886, 0.19879129460806833, 0.18512429646085105, 0.17172223987153262, 0.15861844446445114, 0.1458454883396505, 0.13343512707859195, 0.1214182147947735, 0.10982462742554322, 0.09868318845581184, 0.08802159725832706, 0.07786636022866922, 0.06824272488617511, 0.05917461710462679, 0.05068458162875997, 0.04279372602447573, 0.035521668202106615, 0.028886487643200287, 0.022904680452079274, 0.017591118343927403, 0.012959011671361653, 0.009019876581414732, 0.005783506384578974, 0.0032579472070931037, 0.001449477987004899, 0.0003625948637418497, 0.0]

def _fit_func(data,Amp,wR,wI,phase):
    total =  Amp * np.sin(wR*times+phase)* np.exp(wI*times) 
    return total

from scipy.optimize import curve_fit

# Initialising from rough fits
initialParameters = [1.0, 1.0, -1.0, 1.0]
data = 0
# here a non-linear surface fit is made with scipy's curve_fit()
fittedParameters, pcov = curve_fit(_fit_func, data, Ref, p0=initialParameters)

print('fitted parameters', fittedParameters)

modelPredictions = _fit_func(data,*fittedParameters)

zData = Imf
absError = (modelPredictions - zData)

SE = np.square(absError/zData) # squared errors
MSE = np.mean(SE) # mean squared errors
RMSE = np.sqrt(MSE) # Root Mean Squared Error, RMSE
Rsquared = 1.0 - (np.var(absError) / np.var(zData))
print('RMSE:', RMSE)
print('R-squared:', Rsquared)

import cmath

def omega_from_f(dataR,dataI,times):
    f = dataR + 1j*dataI
    phases = np.zeros_like(dataR)
    for i in range(times.size):
        phases[i] = cmath.phase(f[i])
    return phases

def find_period(data,times):
    saw_points = []
    saw_times = []
    saw_indices = []
    max_slope = 0
    min_slope = 0
    dtinv = (times[2]-times[1])**-1
    min_slope = (data[1]-data[0])*dtinv
    for i in range(times.size-1):
        slope = (data[i+1]-data[i])*dtinv
        if np.abs(slope) - np.abs(min_slope) > 5*np.abs(min_slope) :
            max_slope = slope
            saw_points.append(data[i])
            saw_times.append(times[i])
            saw_indices.append(i)
        else:
            min_slope = slope
    #print('saw indices = ',saw_indices)
    for i in saw_indices:
        for j in range(times.size):
            if j>i:
                data[j]-=2*np.pi
    #delta_t = saw_times[2]-saw_times[1]
    #omegaR = 2 * np.pi/(delta_t)
    #print('omegaR = ',omegaR)
    #np.array([saw_points,saw_times])
    slope, intercept, r_value, p_value, std_err = stats.linregress(times,data)
    print('wr = ',slope," with err ",std_err)
    return data,slope


def find_omegaI(dataR,dataI,times):
    f = dataR + 1j*dataI
    Amp = abs(f)
    wI = np.log(Amp)/times
    slope, intercept, r_value, p_value, std_err = stats.linregress(times,np.log(Amp))
    half_num_points = int(wI.size/2)
    print('omegaI = ', slope)
    return Amp


phases_LRn = omega_from_f(RefLRn,ImfLRn,timesLRn)
data2,slope = find_period(phases_LRn,timesLRn)
ampLLR = find_omegaI(RefLRn,ImfLRn,timesLRn)

phases = omega_from_f(Ref,Imf,times)
data,slope1 = find_period(phases,times)
amp = find_omegaI(Ref,Imf,times)

#phasesHR = omega_from_f(RefHR,ImfHR,timesHR)
#dataHR,slope2 = find_period(phasesHR,timesHR)
#ampHR = find_omegaI(RefHR,ImfHR,timesHR)

print((slope+ 0.5326002435510183)/(slope1+0.5326002435510183))

plt.figure()
#plt.plot(rs_ID,cheb_ID,label='cheb reconstructed')
#plt.plot(rs_ID,ID,label='vr solved')
#plt.plot(times,modelPredictions)
#plt.plot(times,phases,'o',label='logf')
#plt.plot(times,data,'o')
#plt.plot(timesLRn,data2,'o',label='LR')
#plt.plot(timesLRn,ImfLRn,label='Imf')
#plt.plot(times,Imf)
plt.plot(timesLRn,np.log(ampLLR),label='50 pts')
plt.plot(times,np.log(amp),label='100 pts')
#plt.plot(timesHR,np.log(ampHR),label='HR')
plt.plot(times,-5-times*0.08,label='slope wi')
plt.legend()
plt.ylabel('Log Amp(psi0)')
plt.xlabel('rs')

plt.figure()
plt.plot(timesLRn,data2,'o',label='LR')
plt.plot(times,data,'o',label='MR')
#plt.plot(timesHR,dataHR,'o',label='HR')
plt.legend()
plt.ylabel('Log Amp(psi0)')
plt.xlabel('rs')

reflected = []

plt.figure()
plt.plot(rs_ID,ID,'o',label='read in')
plt.plot(rs_read_in,read_in_ID,'o',label='vr')
plt.legend()
plt.ylabel('Re(psi0)')
plt.xlabel('rs')

plt.figure()
plt.plot(timesLRn,RefLRn,label='lr')
plt.plot(times,Ref,label='mr')
plt.legend()
plt.ylabel('Re(psi0)')
plt.xlabel('rs')



plt.show()

